# GenerateWebAppScript
This describes the process being used to generate a webapp for modules installed in meveo when the WebAppRouterModule is installed.

## Artifacts used
1. _**WebApplication** Custom Entity_  - currently this entity contains details on the generated Web Application's configuration.  Future enhancements to this entity will allow a full Web Application to be configured with child entities for the Web Application, Pages, Forms, Fields, etc.
2. _**GenerateModuleWebApp** Notification_ - This notification is used to trigger the _GenerateWebAppScript_ after a module is installed by hooking the a _MeveoModule_'s  _POST_INSTALL_ event.

## Process
1. When the installation of a _MeveoModule_ is being completed, it triggers a _POST_INSTALL_ event which is caught by the _GenerateModuleWebApp_ notification.
2. _GenerateModuleWebApp_ executes _GenerateWebAppScript_ passing in the _code_ of the module that was installed.
3. _GenerateWebAppScript_ will take use code and retrieve the module details which includes its defined _Custom Entities_.
4. The script retrieves the _WebApplication_ repository in meveo git if it exists but if not, it will create a new _WebApplication_ repository by cloning [mv-template](https://github.com/meveo-org/mv-template).  This will be used as the template for every Web Application that will be generated by the script.
5. A repository with the same name as the module's _code_ is then retrieved if it exists but if not, the repository is created.  This repository which will be referred to as the _WebAppRepo_ will contain the web application files copied from the _WebApplication_ repository along with _config_ and _model_ files which will be generated by the script.
6. The script will then iterate over the files in the _WebApplication_ repository and copy over the files that are common to all web applications served by the _WebAppRouter_.
7. _config_ and _model_ files will also be generated by iterating over the _module_'s defined _Custom Entities_(CET) allowing separate _list, new, and update_ pages to be generated for each CET.
8. The copied and generated files in the repository are committed into the _WebAppRepo_'s **meveo** branch.
9. The contents of the **meveo** branch are then merged into the **master** branch of the _WebAppRepo_ and if no merge conflicts are found, will be committed automatically.  Otherwise, the **master** branch is left unchanged and a log message is printed out stating that the branches need to be manually merged by the user.
10. The *code, label, entities, and ROOT_PATH* for the newly created web application are then saved into its own _WebApplication_ custom entity instance which will be used later on by the _WebAppRouter_ to load the correct files when loading the web application into the browser.
11. The generated application will then be accessible through: _{Meveo Server URL}/meveo/rest/webapp/{CET Code}_.